# ─────────────────────────────────────────────────────────────────────
#  LogSentinel AI — Fluent Bit Custom Parsers
# ─────────────────────────────────────────────────────────────────────
#
#  These parsers supplement the built-in Fluent Bit parsers.
#  The syslog input plugin can use the built-in parsers directly
#  (syslog-rfc5424, syslog-rfc3164) — they are defined here as
#  overrides only if you need to customize them.
# ─────────────────────────────────────────────────────────────────────

# ── RFC 5424 (modern syslog) ──────────────────────────────────────
[PARSER]
    Name         syslog-rfc5424
    Format       regex
    Regex        ^\<(?<pri>[0-9]{1,5})\>1 (?<time>[^ ]+) (?<host>[^ ]+) (?<ident>[^ ]+) (?<pid>[-0-9]+) (?<msgid>[^ ]+) (?<extradata>(\[(.*?)\]|-)+) (?<message>.+)$
    Time_Key     time
    Time_Format  %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep    On

# ── RFC 3164 (legacy / BSD syslog) ────────────────────────────────
[PARSER]
    Name         syslog-rfc3164
    Format       regex
    Regex        ^\<(?<pri>[0-9]+)\>(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[a-zA-Z0-9_\/\.\-]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? *(?<message>.+)$
    Time_Key     time
    Time_Format  %b %d %H:%M:%S
    Time_Keep    On

# ── RFC 3164 without PRI (some devices omit the priority) ─────────
[PARSER]
    Name         syslog-rfc3164-nopri
    Format       regex
    Regex        ^(?<time>[^ ]* {1,2}[^ ]* [^ ]*) (?<host>[^ ]*) (?<ident>[a-zA-Z0-9_\/\.\-]*)(?:\[(?<pid>[0-9]+)\])?(?:[^\:]*\:)? *(?<message>.+)$
    Time_Key     time
    Time_Format  %b %d %H:%M:%S
    Time_Keep    On

# ── JSON (for structured log sources) ─────────────────────────────
[PARSER]
    Name         json
    Format       json
    Time_Key     timestamp
    Time_Format  %Y-%m-%dT%H:%M:%S.%L%z
    Time_Keep    On
